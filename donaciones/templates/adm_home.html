{% extends "base.html" %}
{% block title %}Bienvenido{% endblock %}

{% block content %}
	<div class="contenedor z-depth-3 white">
		<div class="row">
			<h5><span><i class="material-icons">date_range</i></span>
			Resumen del día</h5>
		</div>
		<div class="row">
			<div class="col s12 m6">
				<div class="card z-depth-4">
					<div class="center-align black white-text">	
						<span class="card-title"><span><i class="material-icons">card_giftcard</i></span>Donaciones recibidas éste mes</span>
					</div>
					<div class="grey lighten-2" id='donations_graph'>
				    
				  	</div>		
						<script type="text/javascript">
						    Highcharts.chart('donations_graph', {
						    chart: {
						        plotBackgroundColor: null,
						        plotBorderWidth: null,
						        plotShadow: false,
						        type: 'pie'
						    },
					        title: {
					            text: ''
					        },
					        tooltip: {
					            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					        },
					        plotOptions: {
					            pie: {
					                allowPointSelect: true,
					                cursor: 'pointer',
					                dataLabels: {
					                    enabled: true,
					                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
					                    style: {
					                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
					                    }
					                }
					            }
					        },
					        series: [{
					            name: 'Donaciones',
					            colorByPoint: true,
					            data: [
					            {% for d in data_d %}
					              {
					                name: '{{ d.donation_type }}',
					                y: {{ d.total }}
					              },
					            {% endfor %}
					          ]
					        }]
					      });
						</script>
				</div>
			</div>

			<div class="col s12 m6">
				<div class="card z-depth-3">
					<div class="center-align  black white-text">	
						<span class="card-title"><span><i class="material-icons">monetization_on</i></span>Ventas realizadas éste mes</span>
					</div>
					<div class="grey lighten-2" id="sales_graph">
						<!-- ACA VENTAS -->
					</div>
					<script type="text/javascript">
						    Highcharts.chart('sales_graph', {
						    chart: {
						        plotBackgroundColor: null,
						        plotBorderWidth: null,
						        plotShadow: false,
						        type: 'pie'
						    },
					        title: {
					            text: ''
					        },
					        tooltip: {
					            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					        },
					        plotOptions: {
					            pie: {
					                allowPointSelect: true,
					                cursor: 'pointer',
					                dataLabels: {
					                    enabled: true,
					                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
					                    style: {
					                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
					                    }
					                }
					            }
					        },
					        series: [{
					            name: 'Ventas',
					            colorByPoint: true,
					            data: [
					            {% for d in data_s %}
					              {
					                name: '{{ d.product_type }}',
					                y: {{ d.total }}
					              },
					            {% endfor %}
					          ]
					        }]
					      });
						</script>
				</div>
			</div>
		</div>

		<div class="row">
			<h5><span><i class="material-icons">tune
</i></span>Ajustes</h5>
		</div>

		<div class="row">
			<div class="col s12 m4">
				<div class="card z-depth-3">
					<div class="center-align  black white-text">	
						<span class="card-title">
							<span>
								<i class="material-icons">recent_actors</i></span>Usuarios</span>
					</div>

					<div class="grey lighten-2">

					<ul class="collection with-header">
					{% for u in users %}
				        <li class="collection-item">
				        	<div>
				        		{{u.username|lower}}
				        		<span class="secondary-content">
				        			{% if u.last_login is not Null %}
				        				{{u.last_login|date:"d/m/Y"}}
				        			{% else %}
				        				No entró
				        			{% endif %}
				        		</span>
				        	</div>
				        </li>
			        {% endfor %}
			      	</ul>
			    </div>
			    <div class="divisor"></div>
					<div class="card-action right-align">
						<a href="{% url 'register_user' %}" class="btn-floating btn-large waves-effect waves-light red z-depth-3 tooltipped" data-position="top" data-tooltip="AGREGAR NUEVO USUARIO"><i class="material-icons">person_add</i></a>
					</div>
				</div>
			</div>


			<div class="col s12 m4">
				<div class="card z-depth-3">
					<div class="center-align  black white-text">	
						<span class="card-title">
							<span>
								<i class="material-icons">layers</i></span>Artículos</span>
					</div>

					<div class="grey lighten-2">

					<ul class="collection with-header">
					{% for a in arts %}
				        <li class="collection-item">
				        	<div>
				        		{{a.name}}
				        		<span class="secondary-content">
				        			${{a.price}}
				        		</span>
				        	</div>
				        </li>
			        {% endfor %}
			        
			      </ul>

			    </div>
			    <div class="divisor"></div>
					<div class="card-action right-align">
						<a href="/tipos_productos/" class="btn-floating btn-large waves-effect waves-light red z-depth-3 tooltipped" data-position="top" data-tooltip="MODIFICAR PRECIOS"><i class="material-icons">monetization_on</i></a>
					</div>
					
				</div>
			</div>



			<div class="col s12 m4">
				<div class="card z-depth-3">
					<div class="center-align  black white-text">	
						<span class="card-title">
							<span>
								<i class="material-icons">card_giftcard</i></span>Donaciones</span>
					</div>

					<div class="grey lighten-2">

					<ul class="collection with-header">
					{% for d in donations %}
				        <li class="collection-item">
				        	<div>
				        		{{d.name}}
				        		<span class="secondary-content">
				        			{{d.quantity_total}}{{d.unit_measure}}
				        		</span>
				        	</div>
				        </li>
			        {% endfor %}  
			      </ul>

			    </div>
			    <div class="divisor"></div>
					<div class="card-action right-align">
						<a href="/cargar_tipos_donacion/" class="btn-floating btn-large waves-effect waves-light red z-depth-3 tooltipped" data-position="top" data-tooltip="AGREGAR NUEVO TIPO DE DONACIÓN"><i class="material-icons">add</i></a>
					</div>
				</div>
			</div>



		</div>
		




		<div id="modal" class="modal">
			<div class="modal-content">
			  <h4>Descripciones:</h4>
			  	<p>
			  		<div class="collection">
					  		<table class="centered">
					  			<thead>
					  				<tr>
					  					<th>Descripción</th>
					  					<th>Cantidad</th>
					  				</tr>
					  			</thead>
					  			<tbody>
							  		{% for d,c in my_list %}
						  				<tr>
						  					<td>{{d}}</td>
						  					<td>{{c}}</td>
						  				</tr>
					  				{%endfor%}
					  			</tbody>
					  		</table>
			  		</div>
			  	</p>
			</div>
			<div class="modal-footer">
			  	<a href="#!" class="modal-close waves-effect waves-green btn-flat">Aceptar</a>
			</div>
		</div>
	</div>

{% endblock %}
{% block extra_js %}
	<script type="text/javascript">
	  $(document).ready(function(){
	    $('.modal').modal();
	  });	
	</script>

	<script type="text/javascript">
	  $(document).ready(function(){
	    $('.tooltipped').tooltip();
	  });
	</script>
{% endblock %}